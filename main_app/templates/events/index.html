{% extends 'base.html' %}
{% block content %}
<h1>All Events</h1>
{% for event in events %}
{% if event.date >= today %}
<div class="card">
  <div class="row">
    <div class="col s6">
      <div class="card-content">
          <a href="{% url 'detail' event.id %}">
            <span class="card-title">{{ event.title }}</span>
          </a>
          <br>
        <p>Date: {{ event.date }}</p>
        <p>Time: {{ event.time }}</p>
        <p>Description: {{ event.description }}</p>
        <p>Address: {{ event.address }}</p>
        <p>Neighborhood: {{ event.neighborhood }}</p>
        <p>City: {{ event.city }}</p>
      </div>
    </div>
    <div class="col s6">
      <div>
        {% for photo in event.photo_set.all %}
        {% if forloop.counter == 1 %}
        <img class="responsive-img card-panel" src="{{photo.url}}">
        {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
</div>
{% endif %}
{% endfor %}
<br>
<hr>
<h2>Past Events</h2>
{% for event in events %}
{% if event.date < today %} 
<div class="card">
  <div class="row">
    <div class="col s6">
      <div class="card-content">
        <a href="{% url 'detail' event.id %}">
          <span class="card-title">{{ event.title }}</span>
          <br>
        </a>
        <p>Date: {{ event.date }}</p>
        <p>Time: {{ event.time }}</p>
        <p>Description: {{ event.description }}</p>
        <p>Address: {{ event.address }}</p>
        <p>Neighborhood: {{ event.neighborhood }}</p>
        <p>City: {{ event.city }}</p>
      </div>
    </div>
    <div class="col s6">
    <br>
    <p>Average Rating</p>
      <div id="star-field">
        {% if event.average_rating >= 0 and event.average_rating <= 1.5 %} 
        <span class="yes-star">&#9733;</span>
        <span class="no-star">&#9733;</span>
        <span class="no-star">&#9733;</span>
        <span class="no-star">&#9733;</span>
        <span class="no-star">&#9733;</span>
        {% endif %}
        {% if event.average_rating > 1.5 and event.average_rating <= 2.5 %}
        <span class="yes-star">&#9733;</span>
        <span class="yes-star">&#9733;</span>
        <span class="no-star">&#9733;</span>
        <span class="no-star">&#9733;</span>
        <span class="no-star">&#9733;</span>
        {% endif %}
        {% if event.average_rating > 2.5 and event.average_rating <= 3.5 %}
        <span class="yes-star">&#9733;</span>
        <span class="yes-star">&#9733;</span>
        <span class="yes-star">&#9733;</span>
        <span class="no-star">&#9733;</span>
        <span class="no-star">&#9733;</span>
        {% endif %}
        {% if event.average_rating > 3.5 and event.average_rating <= 4.5 %}
        <span class="yes-star">&#9733;</span>
        <span class="yes-star">&#9733;</span>
        <span class="yes-star">&#9733;</span>
        <span class="yes-star">&#9733;</span>
        <span class="no-star">&#9733;</span>
        {% endif %}
        {% if event.average_rating > 4.5 %}
        <span class="yes-star">&#9733;</span>
        <span class="yes-star">&#9733;</span>
        <span class="yes-star">&#9733;</span>
        <span class="yes-star">&#9733;</span>
        <span class="yes-star">&#9733;</span>
        {% endif %}
      </div>
      <div>
        {% for photo in event.photo_set.all %}
        {% if forloop.counter == 1 %}
        <img class="responsive-img card-panel" src="{{photo.url}}">
        {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
  </div>
  {% endif %}
  {% endfor %}
  <!-- <script>
    const rate = (rating, event_id) => {
        fetch(`/rate/${event_id}/${rating}/`, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        }).then(rest => {
            window.location.reload();
            // you may want to update the rating here
            // to simplify stuff, I just reload the page
        })
    }
  </script> -->
  {% endblock %}